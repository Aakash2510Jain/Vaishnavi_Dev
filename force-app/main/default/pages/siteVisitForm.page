<apex:page sidebar="false" showHeader="false" standardStylesheets="false" controller="siteVisitFormController">
    <html>
        <head>
            <apex:stylesheet value="{!$Resource.BookingFormCSS}" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.6/semantic.css"/>
            <c:Libraries ></c:Libraries>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
            <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>  -->
            <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800&display=swap" rel="stylesheet" />
            <link href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" rel="stylesheet"/>
            
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"/>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular.js"/>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.6/semantic.js">
            </script>
        </head>

        <script>
            var ageGroup = JSON.parse('{!ageGroup}');
            var employmentType = JSON.parse('{!employmentType}');
            var budget = JSON.parse('{!budget}');
            var area = JSON.parse('{!area}');
            var constructionStatus = JSON.parse('{!constructionStatus}');
            var purposeOfBuying = JSON.parse('{!purposeOfBuying}');
            var walkinSource = JSON.parse('{!walkinSource}');
            var gender = JSON.parse('{!gender}');
            var facilitatedBy = JSON.parse('{!facilitatedBy}');
            var classification = JSON.parse('{!classification}');
            var leadClassification = JSON.parse('{!leadClassification}');
            var closedReason = JSON.parse('{!closedReason}');
            var ownership = JSON.parse('{!ownership}');
            var sourceOfFunding = JSON.parse('{!sourceOfFunding}');
            var ethnicity = JSON.parse('{!ethnicity}');
            var flatType = JSON.parse('{!flatType}');
            var UserId = '{!UserId}';


//             angular.module('number', [])
//     .directive('number', function () {
//         return {
//             require: 'ngModel',
//             restrict: 'A',
//             link: function (scope, element, attrs, ctrl) {
//                 ctrl.$parsers.push(function (input) {
//                     if (input == undefined) return ''
//                     var inputNumber = input.toString().replace(/[^0-9]/g, '');
//                     if (inputNumber != input) {
//                         ctrl.$setViewValue(inputNumber);
//                         ctrl.$render();
//                     }
//                     return inputNumber;
//                 });
//             }
//         };
// });

// angular.module('decimal', [])
//     .directive('decimal', function () {
//         return {
//             require: 'ngModel',
//             restrict: 'A',
//             link: function (scope, element, attrs, ctrl) {
//                 ctrl.$parsers.push(function (input) {
//                     if (input == undefined) return ''
//                     var inputNumber = input.toString().replace(/[^0-9/.]/g, '');
//                     if (inputNumber != input) {
//                         ctrl.$setViewValue(inputNumber);
//                         ctrl.$render();
//                     }
//                     return inputNumber;
//                 });
//             }
//         };
// });

            var app = angular.module('visit_app', []);
            app.controller('visit_ctrl', function ($scope) {
                debugger;
                $scope.isDisabled = false;
                $scope.subSource = ['99 Acres','Commonfloor','Housing','Magicbricks'];
                $scope.today = new Date();
                var dateTime = $scope.today.toLocaleString();
                var parts = dateTime.split(', ');
                var timeString = parts[1];
                var rightTwoChars = timeString.slice(-2);

                var hours = $scope.today.getHours();
                var minutes = $scope.today.getMinutes();
                debugger;
                $scope.timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`+' '+rightTwoChars;  
                // document.getElementById('timeInput').value = $scope.timeString;              
                $scope.ageGroup = ageGroup;
                $scope.employmentType = employmentType;
                $scope.budget = budget;
                $scope.area = area;
                $scope.constructionStatus = constructionStatus;
                $scope.purposeOfBuying = purposeOfBuying;
                $scope.walkinSource = walkinSource;
                $scope.gender = gender;
                $scope.facilitatedBy = facilitatedBy;
                $scope.classification = classification;
                $scope.leadClassification = leadClassification;
                $scope.closedReason = closedReason;
                $scope.ownership = ownership;
                $scope.sourceOfFunding = sourceOfFunding;
                $scope.ethnicity = ethnicity;
                $scope.flatType = flatType;
                $scope.UserId = UserId;
                $scope.visit = {};
                
                $scope.errorMsg = false;
                $scope.showLeadDetails = false;
                $scope.showCreateLead = false;
                $scope.showVisitAfterCreatn = false;
                $scope.showConvertedLead = false;

                $scope.showProjectsErrMsg = false;
                $scope.showErrmsgOppSV = false;
                
                $scope.showVisitSection = false;
                $scope.showCustReq = false;
                $scope.visitDet = false;
                $scope.showGRE = false;
                $scope.showSalesManager = false;
                $scope.listOfLocation = [];
                $scope.listOfChannelPartner = [];
                $scope.selectedId;
                $scope.visit.Channel_Partner__c = "";
                $scope.activationInputText = "";

                $scope.getLocationList = function(){
                    debugger;
                    siteVisitFormController.getLocationList(function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.listOfLocation = result;
                            $scope.$apply();
                        }
                    })
                }
                $scope.getLocationList();

                $scope.getProjectsData = function(){
                    debugger;
                    siteVisitFormController.getProjectsData($scope.UserId,function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.projectId = result.Project__c;
                            $scope.projectName = result.Project__r.Name;
                            $scope.$apply();
                            $scope.getBudgetAndUnitOfProject();
                        }
                    })
                }
                $scope.getProjectsData();

                $scope.budgetValue = [];
                $scope.unitValue = [];
                $scope.getBudgetAndUnitOfProject = function(){
                    debugger;
                    siteVisitFormController.getBudgetAndUnitOfProject($scope.projectName,function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.budgetValue = result.Budget__c.split(',');
                            // for(i=0;i<$scope.budgetValue.length;i++){
                            //     if($scope.budgetValue[i].includes("&lt;")){
                            //         $scope.budgetValue[i] = $scope.budgetValue[i].replace(/&lt;/g, "<");
                            //     }
                            //     if($scope.budgetValue[i].includes("&gt;")){
                            //         $scope.budgetValue[i] = $scope.budgetValue[i].replace(/&gt;/g, ">");
                            //     }
                            // }
                            $scope.unitValue = result.Unit__c.split(',');
                            $scope.$apply();
                        }
                    })
                }


                $scope.getSalesManager = function(){
                    debugger;
                    siteVisitFormController.getSalesManager(function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.listOfSalesManager = result;
                            $scope.$apply();
                        }
                    })
                }
                $scope.getSalesManager();

                $scope.getChannelPartners = function(){
                    debugger;
                    siteVisitFormController.getChannelPartners(function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.listOfChannelPartner = result;
                            $scope.$apply();
                        }
                    })
                }
                $scope.getChannelPartners();

                $scope.searchLead2 = function(){
                    debugger;
                    siteVisitFormController.searchLead($scope.searchValue,$scope.projectId,function(result,event){
                        debugger;
                        if(event.status && result){
                            if(result.leadRec != null){
                                console.log('success....');
                                $scope.leadDetails = result.leadRec;
                                $scope.$apply();
                            }else{
                                console.log('success....');
                                $scope.oppDetails = result.oppRec;
                                $scope.oppId = result.oppRec.Id;
                                $scope.siteVisitList = result.visitList;
                                if($scope.siteVisitList.length > 0){
                                    for(var i=0; i<$scope.siteVisitList.length;i++){
                                        debugger;
                                        if($scope.siteVisitList[i].Actual_visit_date__c != null){
                                            $scope.siteVisitList[i].Actual_visit_date__c = new Date($scope.siteVisitList[i].Actual_visit_date__c);
                                        }
                                    }
                                }
                                $scope.$apply();
                            }
                            
                        }else{
                        }
                        $scope.getleadDet();
						$scope.$apply();
                    })
                }

                $scope.searchLead = function(){
                    debugger;
                    siteVisitFormController.searchLead($scope.searchValue,$scope.projectId,function(result,event){
                        debugger;
                        if(event.status && result){
                            if(result.leadRec != null){
                                console.log('success....');
                                $scope.leadDetails = result.leadRec;
                                $scope.leadId = result.leadRec.Id;
                                $scope.showLeadDetails = true;
                                $scope.errorMsg = false;
                                $scope.showCreateLead = false;
                                $scope.$apply();
                            }else{
                                console.log('success....');
                                $scope.oppDetails = result.oppRec;
                                $scope.oppId = result.oppRec.Id;
                                $scope.siteVisitList = result.visitList;
                                if($scope.siteVisitList.length > 0){
                                    for(var i=0; i<$scope.siteVisitList.length;i++){
                                        debugger;
                                        if($scope.siteVisitList[i].Actual_visit_date__c != null){
                                            $scope.siteVisitList[i].Actual_visit_date__c = new Date($scope.siteVisitList[i].Actual_visit_date__c);
                                        }
                                    }
                                }
                                //$scope.leadId = result.Id;
                                $scope.showLeadDetails = false;
                                $scope.errorMsg = false;
                                $scope.showCreateLead = false;
                                $scope.showConvertedLead = true;
                                $scope.showVisitSection = false;
                                $scope.showCustReq = false;
                                $scope.visitDet = false;
                                $scope.showGRE = false;
                                $scope.showSalesManager = false;
                                $scope.$apply();
                            }
                            
                        }else{
                            $scope.errorMsg = true;
                            $scope.showLeadDetails = false;
                            $scope.showCreateLead = false;
                            $scope.showVisitSection = false;
                            $scope.showCustReq = false;
                            $scope.visitDet = false;
                            $scope.showGRE = false;
                            $scope.showSalesManager = false;
                        }
                        $scope.getleadDet();
						$scope.$apply();
                    })
                }

                $scope.createLead = function(){
                    debugger;
                    $scope.showCreateLead = true;
                    $scope.errorMsg = false;
                    $scope.showLeadDetails = false;
                    $scope.showVisitSection = false;
                    $scope.showCustReq = false;
                    $scope.visitDet = false;
                    $scope.showGRE = false;
                    $scope.showSalesManager = false;
                }

                $scope.createLeadRecord = function(){
                    debugger;
                    // $scope.isDisabled = true;
                    // $scope.showSpinner = true;
                    $("#btnSubmit").hide();
                    $("#btnPleaseWait").show();
                    siteVisitFormController.createLeadRecord($scope.ledDetails,function(result,event){
                       debugger;
                       $("#btnPleaseWait").hide();
                       $("#btnSubmit").show(); 
                    //    $scope.isDisabled = false;
                    //    $scope.showSpinner = false;
                       if(event.status && result){
                            debugger;
                            $scope.leadId = result;
                            $scope.$apply();
                            swal({
                                icon: 'success',
                                title: 'success',
                                text: 'Lead has been created successfully..'
                            })

                            $scope.showVisitAfterCreatn = true;
                            $scope.getleadDet();
                            $scope.$apply();
                       }
                    })
                }

                $scope.searchName;
                $scope.leadRecord = [];
                $scope.getleadDet = function(){
                    debugger;
                    if($scope.searchValue != null){
                        $scope.searchName = $scope.searchValue;
                    }else{
                        $scope.searchName = $scope.leadDetails.Name__c ;
                    }

                    siteVisitFormController.getLeadRecords($scope.searchName,function(result,event){
                        debugger;
                        if(event.status){
                            $scope.leadRecord = result;
                            $scope.$apply();
                        }
                    })

                }

                $scope.createCloneVisit = function(){
                    debugger;
                    $("#btnSubmit1").hide();
                    $("#btnPleaseWait1").show();
                    siteVisitFormController.createCloneVisit($scope.latestVisitId,function(result,event){
                        debugger;
                        $("#btnPleaseWait1").hide();
                        $("#btnSubmit1").show();
                        if(event.status && result){
                            debugger;
                            $scope.errorMsg = false;
                            $scope.showLeadDetails = false;
                            $scope.showCreateLead = false;
                            $scope.showVisitAfterCreatn = false;
                            $scope.showConvertedLead = false;

                            $scope.showProjectsErrMsg = true;

                            $scope.showVisitSection = false;
                            $scope.showCustReq = false;
                            $scope.visitDet = false;
                            $scope.showGRE = false;
                            $scope.showSalesManager = false;
                            $scope.$apply();
                        }
                    })
                }

                $scope.cloneOpportunityAndSV = function(){
                    debugger;
                    $("#btnSubmit1").hide();
                    $("#btnPleaseWait1").show();
                    siteVisitFormController.cloneOpportunityAndSV($scope.oppDetails.Id,$scope.latestVisitId,function(result,event){
                        debugger;
                        $("#btnPleaseWait1").hide();
                        $("#btnSubmit1").show();
                        if(event.status && result){
                            $scope.errorMsg = false;
                            $scope.showLeadDetails = false;
                            $scope.showCreateLead = false;
                            $scope.showVisitAfterCreatn = false;
                            $scope.showConvertedLead = false;

                            $scope.showProjectsErrMsg = false;
                            $scope.showErrmsgOppSV = true;

                            $scope.showVisitSection = false;
                            $scope.showCustReq = false;
                            $scope.visitDet = false;
                            $scope.showGRE = false;
                            $scope.showSalesManager = false;
                            $scope.$apply(); 
                        }
                    })
                }

                $scope.cloneOppForDiffProject = function(){
                    debugger;
                    $("#btnSubmit1").hide();
                    $("#btnPleaseWait1").show();
                    siteVisitFormController.cloneOppForDiffProject($scope.oppId,$scope.projectId,function(result,event){
                        debugger;
                        $("#btnPleaseWait1").hide();
                        $("#btnSubmit1").show();
                        if(event.status && result){
                            $scope.oppId = result;
                            $scope.showVisitSection = true;
                            $scope.errorMsg = false;
                            $scope.showLeadDetails = false;
                            $scope.showCreateLead = false;
                            $scope.showVisitAfterCreatn = false;
                            $scope.showConvertedLead = false; 
                            $scope.$apply();
                            }
                    })
                }

                $scope.OnClickcreateVisit = function(){
                    debugger;
                    $scope.searchLead2();
                    if($scope.oppDetails != undefined){
                        if($scope.oppDetails.Project__c == $scope.projectId){
                            $scope.lengthofVisit = $scope.siteVisitList.length;
                            $scope.visitDate = new Date($scope.siteVisitList[$scope.lengthofVisit-1].Actual_visit_date__c);
                            // if($scope.siteVisitList.length > 0){
                            // for(var i=0; i<$scope.siteVisitList.length;i++){
                            //     debugger;
                            //     if($scope.siteVisitList[i].Actual_visit_date__c != null){
                            //         $scope.visitDate = new Date($scope.siteVisitList[i].Actual_visit_date__c);
                            //     }
                            // }
                            // }
                            var timeDiff = Math.abs($scope.today.getTime() - $scope.visitDate.getTime());
                            $scope.days = Math.ceil(timeDiff / (1000 * 3600 * 24));
                            $scope.latestVisitId = $scope.siteVisitList[$scope.lengthofVisit-1].Id;
                            if($scope.oppDetails.Stage__c == 'Lost'){
                                if($scope.days < 30){
                                    $scope.cloneOpportunityAndSV();
                                    $scope.$apply();
                                }else{
                                    $scope.cloneOppForDiffProject();
                                    $scope.$apply();
                                }
                            }else if($scope.days < 30){
                                $scope.createCloneVisit();
                                $scope.$apply();                       
                            }else if($scope.days > 30){
                                $scope.cloneOppForDiffProject();
                                $scope.$apply();
                            }
                        }else if($scope.oppDetails.Project__c != $scope.projectId){
                            $scope.cloneOppForDiffProject();
                            $scope.$apply();
                        }
                        $scope.$apply();

                    }else{
                        $scope.showVisitSection = true;
                        $scope.errorMsg = false;
                        $scope.showLeadDetails = false;
                        $scope.showCreateLead = false;
                        $scope.showVisitAfterCreatn = false;
                        $scope.showConvertedLead = false;
                    }
                    $scope.$apply();
                }

                $scope.changeOfAgeGroup = function(value){
                    debugger;
                    $scope.visit.Age_Group__c = value;
                }

                $scope.ChangeOfEmpType = function(value){
                    debugger;
                    $scope.visit.Employment_Type__c = value;
                }

                // $scope.location1;

                $scope.saveCustomerDet = function(){
                    debugger;
                    if($scope.visit.Date_Of_Birth__c == undefined || $scope.visit.Date_Of_Birth__c == ""){
                            debugger;
                            swal('info','Please Enter Date of Birth.','info');
                            return;
                        }
                    if($scope.visit.Date_Of_Birth__c >= $scope.today){
                        debugger;
                        swal('info','Date of Birth cannot be future date.','info');
                            return;
                    }
                    if($scope.visit.Employment_Type__c == 'Salaried' || $scope.visit.Employment_Type__c == 'Business' || $scope.visit.Employment_Type__c == 'Professional'){
                        if($scope.visit.Company_Name__c == undefined || $scope.visit.Company_Name__c == ""){
                            debugger;
                            swal('info','Please Enter Company Name.','info');
                            return;
                        }
                        if($scope.visit.Office_Address__c == undefined || $scope.visit.Office_Address__c == ""){
                            debugger;
                            swal('info','Please Enter Office Address.','info');
                            return;
                        }
                        if($scope.visit.Office_PinCode__c == undefined || $scope.visit.Office_PinCode__c == ""){
                            debugger;
                            swal('info','Please Enter Pin Code.','info');
                            return;
                        }
                        if($scope.visit.Industry__c == undefined || $scope.visit.Industry__c == ""){
                            debugger;
                            swal('info','Please Enter Industry.','info');
                            return;
                        }
                    }

                    $scope.firstVisitRecord = {"Id":$scope.visit.Id,"Form_No__c":$scope.visit.Form_No__c,"Date_Of_Birth__c":$scope.visit.Date_Of_Birth__c,"Age_Group__c":$scope.visit.Age_Group__c,
                    "Residential_Address__c":$scope.visit.Residential_Address__c,"City__c":$scope.visit.City__c,
                    "Pincode__c":$scope.visit.Pincode__c,"Employment_Type__c":$scope.visit.Employment_Type__c,"Company_Name__c":$scope.visit.Company_Name__c,
                    "Industry__c":$scope.visit.Industry__c,"Office_Address__c":$scope.visit.Office_Address__c,"Office_PinCode__c":$scope.visit.Office_PinCode__c,
                    "Actual_visit_date__c":$scope.today,"Alternate_Phone__c":$scope.visit.Alternate_Phone__c,"Project__c":$scope.leadRecord[0].Project__c};
                    var year = 0
                    var month = 0;
                    var day = 0;
                    if($scope.firstVisitRecord.Date_Of_Birth__c !=undefined && $scope.firstVisitRecord.Date_Of_Birth__c!=''){
                        year = $scope.firstVisitRecord.Date_Of_Birth__c.getUTCFullYear();
                        month = $scope.firstVisitRecord.Date_Of_Birth__c.getUTCMonth()+1;
                        day = $scope.firstVisitRecord.Date_Of_Birth__c.getDate();
                    }
                    if($scope.firstVisitRecord.Actual_visit_date__c !=undefined && $scope.firstVisitRecord.Actual_visit_date__c!=''){
                        visityear = $scope.firstVisitRecord.Actual_visit_date__c.getUTCFullYear();
                        visitmonth = $scope.firstVisitRecord.Actual_visit_date__c.getUTCMonth()+1;
                        visitday = $scope.firstVisitRecord.Actual_visit_date__c.getDate();
                    }
                    delete($scope.firstVisitRecord.Date_Of_Birth__c);
                    delete($scope.firstVisitRecord.Actual_visit_date__c);

                    if($scope.oppId != null){
                        $scope.firstVisitRecord.Opportunities__c = $scope.oppId;
                        $scope.firstVisitRecord.Project__c = $scope.oppDetails.Project__c;
                    }else{
                        $scope.firstVisitRecord.Lead__c = $scope.leadId;
                        $scope.firstVisitRecord.Project__c = $scope.leadRecord[0].Project__c;
                    }

                    if($scope.visit.Location__c == undefined){
                        $scope.visit.Location__c = "";
                    }


                    if($scope.leadId != undefined){
                        siteVisitFormController.insertVisitRecord($scope.firstVisitRecord,$scope.leadId,year,month,day,visityear,visitmonth,visitday,$scope.visit.Location__c,function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.visitId = result;
                            $scope.visit.Id = result;
                            swal({
                                icon: 'success',
                                title: 'success',
                                text: 'Customer Details have been saved successfully..'
                            })
                            $scope.showCustReq = true;
                            $scope.showVisitSection = false;
                            $scope.visitDet = false;
                            $scope.showGRE = false;
                            $scope.showSalesManager = false;
                            $scope.$apply();
                        }
                    })
                }else{
                    siteVisitFormController.insertVisitRecordUnderOpportunity($scope.firstVisitRecord,year,month,day,visityear,visitmonth,visitday,function(result,event){
                        debugger;
                        if(event.status && result){
                            debugger;
                            $scope.visitId = result;
                            $scope.visit.Id = result;
                            swal({
                                icon: 'success',
                                title: 'success',
                                text: 'Customer Details have been saved successfully..'
                            })
                            $scope.showCustReq = true;
                            $scope.showVisitSection = false;
                            $scope.visitDet = false;
                            $scope.showGRE = false;
                            $scope.showSalesManager = false;
                            $scope.$apply();
                        }
                    })
                }
                    
            }

            $scope.saveCustomerReq = function(){
                    debugger;

                    $scope.secondVisitRecord = {"Budget__c":$scope.visit.Budget__c,"Area__c":$scope.visit.Area__c,
                    "Construction_Status__c":$scope.visit.Construction_Status__c,"Purpose_Of_Buying__c":$scope.visit.Purpose_Of_Buying__c};

                    $scope.secondVisitRecord.Id = $scope.visitId;

                    if($scope.oppId != null){
                        $scope.secondVisitRecord.Opportunities__c = $scope.oppId;
                    }else{
                        $scope.secondVisitRecord.Lead__c = $scope.leadId;
                    }
                    siteVisitFormController.updateVisitRecord($scope.secondVisitRecord,null,function(result,event){
                    debugger;
                    if(event.status && result){
                        debugger;
                        swal({
                            icon: 'success',
                            title: 'success',
                            text: 'Customer Requirement Details have been saved successfully..'
                        })
                        $scope.visitDet = true;
                        $scope.showCustReq = false;
                        $scope.showVisitSection = false;
                        $scope.showGRE = false;
                        $scope.showSalesManager = false;
                        $scope.$apply();
                    }
                })
            }

            $scope.savevisitDetails = function(){
                    debugger;
                    if($scope.activationInputText != ""){
                        $scope.visit.Walkin_Sub_Source__c = $scope.activationInputText;
                    }

                    $scope.thirdVisitRecord = {"Walkin_Source__c":$scope.visit.Walkin_Source__c,"Walkin_Sub_Source__c":$scope.visit.Walkin_Sub_Source__c,
                    "Projects__c":$scope.visit.Projects__c,"GR_Code__c":$scope.visit.GR_Code__c,"Channel_Partner_Not_registered__c":$scope.visit.Channel_Partner_Not_registered__c,
                    "Firm_Name__c":$scope.visit.Firm_Name__c,"Apartment_No__c":$scope.visit.Apartment_No__c,
                    "Channel_Partner_Mobile_No__c":$scope.visit.Channel_Partner_Mobile_No__c,"RERA_No__c":$scope.visit.RERA_No__c,
                    "Channel_Partner_Email__c":$scope.visit.Channel_Partner_Email__c,"Referral_Name__c":$scope.visit.Referral_Name__c,
                    "Referral_Mobile_No__c":$scope.visit.Referral_Mobile_No__c};


                    $scope.thirdVisitRecord.Id = $scope.visitId;

                    if($scope.oppId != null){
                        $scope.thirdVisitRecord.Opportunities__c = $scope.oppId;
                    }else{
                        $scope.thirdVisitRecord.Lead__c = $scope.leadId;
                    }
                    siteVisitFormController.updateVisitRecord($scope.thirdVisitRecord,$scope.visit.Channel_Partner__c,function(result,event){
                    debugger;
                    if(event.status && result){
                        debugger;
                        swal({
                            icon: 'success',
                            title: 'success',
                            text: 'Visit Details have been saved successfully..'
                        })
                        $scope.showGRE = true;
                        $scope.visitDet = false;
                        $scope.showCustReq = false;
                        $scope.showVisitSection = false;
                        $scope.showSalesManager = false;
                        $scope.$apply();
                    }
                })
            }

            $scope.saveGREDetails = function(){
                    debugger;

                    $scope.forthVisitRecord = {"Sales_Manager__c":$scope.visit.Sales_Manager__c,
                    "Facilitated_By__c":$scope.visit.Facilitated_By__c,
                    "Customer_Time_In__c":$scope.today};

                    // var year = 0
                    // var month = 0;
                    // var day = 0;
                    // if($scope.forthVisitRecord.GRE_Date_of_Birth__c !=undefined && $scope.forthVisitRecord.GRE_Date_of_Birth__c!=''){
                    //     year = $scope.forthVisitRecord.GRE_Date_of_Birth__c.getUTCFullYear();
                    //     month = $scope.forthVisitRecord.GRE_Date_of_Birth__c.getUTCMonth()+1;
                    //     day = $scope.forthVisitRecord.GRE_Date_of_Birth__c.getDate();
                    // }

                    var sHour = 0
                    var sMin = 0;
                    if ($scope.forthVisitRecord.Customer_Time_In__c != undefined && !angular.isNumber($scope.forthVisitRecord.Customer_Time_In__c)) {
                        sHour = $scope.forthVisitRecord.Customer_Time_In__c.getHours();
                        sMin = $scope.forthVisitRecord.Customer_Time_In__c.getMinutes();
                    }

                    var oHour = 0
                    var oMin = 0;
                    if ($scope.forthVisitRecord.Customer_Time_Out__c != undefined && !angular.isNumber($scope.forthVisitRecord.Customer_Time_Out__c)) {
                        oHour = $scope.forthVisitRecord.Customer_Time_Out__c.getHours();
                        oMin = $scope.forthVisitRecord.Customer_Time_Out__c.getMinutes();
                    }

                    $scope.forthVisitRecord.Id = $scope.visitId;
                    // delete($scope.forthVisitRecord.GRE_Date_of_Birth__c);
                    delete($scope.forthVisitRecord.Customer_Time_In__c);
                    // delete($scope.forthVisitRecord.Customer_Time_Out__c);

                    if($scope.oppId != null){
                        $scope.forthVisitRecord.Opportunities__c = $scope.oppId;
                    }else{
                        $scope.forthVisitRecord.Lead__c = $scope.leadId;
                    }
                    siteVisitFormController.updateGREDetails($scope.forthVisitRecord,sHour,sMin,function(result,event){
                    debugger;
                    if(event.status && result){
                        debugger;
                        swal({
                            icon: 'success',
                            title: 'success',
                            text: 'To be filled by GRE Details have been saved successfully..'
                        })
                        $scope.showGRE = false;
                        $scope.visitDet = false;
                        $scope.showCustReq = false;
                        $scope.showVisitSection = false;
                        // $scope.showSalesManager = true;
                        $scope.$apply();
                    }
                })
            }

            $scope.finalSubmit = function(){
                    debugger;

                    $scope.finalVisitRecord = {"Form_No__c":$scope.visit.Form_No__c,
                    "Customer_Classicfication__c":$scope.visit.Customer_Classicfication__c,"Lead_Classification__c":$scope.visit.Lead_Classification__c,
                    "Reason_Of_Lead_Closed__c":$scope.visit.Reason_Of_Lead_Closed__c,"Current_House_Ownership__c":$scope.visit.Current_House_Ownership__c,
                    "Configuration__c":$scope.visit.Configuration__c,"Family_Size__c":$scope.visit.Family_Size__c,"Current_Floor_No__c":$scope.visit.Current_Floor_No__c,
                    "Customer_s_Desired_Budget__c":$scope.visit.Customer_s_Desired_Budget__c,"Customer_s_Desired_Location_E_W__c":$scope.visit.Customer_s_Desired_Location_E_W__c,
                    "Source_Of_Funding__c":$scope.visit.Source_Of_Funding__c,"Ethnicity__c":$scope.visit.Ethnicity__c};

                    // var visitYear = 0
                    // var visitMonth = 0;
                    // var visitDay = 0;
                    // if($scope.finalVisitRecord.Actual_visit_date__c !=undefined && $scope.finalVisitRecord.Actual_visit_date__c!=''){
                    //     visitYear = $scope.finalVisitRecord.Actual_visit_date__c.getUTCFullYear();
                    //     visitMonth = $scope.finalVisitRecord.Actual_visit_date__c.getUTCMonth()+1;
                    //     visitDay = $scope.finalVisitRecord.Actual_visit_date__c.getDate();
                    // }

                    $scope.finalVisitRecord.Id = $scope.visitId;

                    if($scope.oppId != null){
                        $scope.finalVisitRecord.Opportunities__c = $scope.oppId;
                    }else{
                        $scope.finalVisitRecord.Lead__c = $scope.leadId;
                    }
                    siteVisitFormController.finalSubmit($scope.finalVisitRecord,function(result,event){
                    debugger;
                    if(event.status && result){
                        debugger;
                        swal({
                            icon: 'success',
                            title: 'success',
                            text: 'To be filled by Sales Manager Details have been saved successfully..'
                        })
                        $scope.showGRE = false;
                        $scope.visitDet = false;
                        $scope.showCustReq = false;
                        $scope.showVisitSection = true;
                        $scope.showSalesManager = false;
                        $scope.$apply();
                    }
                })
            }

            $scope.changeOfBudget = function(value){
                debugger;
                $scope.visit.Budget__c = value;
            }
            $scope.changeOfArea = function(value){
                debugger;
                $scope.visit.Area__c = value;
            }
            $scope.changeOfConstStatus = function(value){
                debugger;
                $scope.visit.Construction_Status__c = value;
            }
            $scope.changeOfPurposeOfBuying = function(value){
                debugger;
                $scope.visit.Purpose_Of_Buying__c = value;
            }
            $scope.changeOfSubSource = function(value){
                debugger;
                $scope.visit.Walkin_Sub_Source__c = value;
            }
            $scope.changeOfActivation = function(){
                debugger;
                $('input[name=radioPurpose]').prop('checked',false);
                // $scope.visit.Walkin_Sub_Source__c = null;
            }

            $scope.changeOfRadioActivation = function(){
                debugger;
                $('#activationText').val('');
            }

            $scope.showFirst = function(){
                debugger;
                $scope.showVisitSection = true;
                $scope.showCustReq = false;
                $scope.visitDet = false;
                $scope.showGRE = false;
                $scope.showSalesManager = false;
            }

            $scope.showSecond = function(){
                debugger;
                $scope.showVisitSection = false;
                $scope.showCustReq = true;
                $scope.visitDet = false;
                $scope.showGRE = false;
                $scope.showSalesManager = false;
            }

            $scope.showThird = function(){
                debugger;
                $scope.showVisitSection = false;
                $scope.showCustReq = false;
                $scope.visitDet = true;
                $scope.showGRE = false;
                $scope.showSalesManager = false;
            }
            $scope.showForth = function(){
                debugger;
                $scope.showVisitSection = false;
                $scope.showCustReq = false;
                $scope.visitDet = false;
                $scope.showGRE = true;
                $scope.showSalesManager = false;
            }

            $scope.changeOfLeadSource = function(value){
                debugger;
                $scope.visit.Walkin_Source__c = value
            }
            $scope.changeOfGender = function(value){
                debugger;
                $scope.visit.Customer_Gender__c = value
            }
            $scope.changeOfFacilitatedBy = function(value){
                debugger;
                $scope.visit.Facilitated_By__c = value
            }

            $scope.changeOfClassification = function(value){
                debugger;
                $scope.visit.Customer_Classicfication__c = value
            }
            $scope.changeOfLeadClassificatn = function(value){
                debugger;
                $scope.visit.Lead_Classification__c = value
            }
            $scope.changeOfLeadClosed = function(value){
                debugger;
                $scope.visit.Reason_Of_Lead_Closed__c = value
            }
            $scope.changeOfOwnership = function(value){
                debugger;
                $scope.visit.Current_House_Ownership__c = value
            }
            $scope.changeOfSourceFunding = function(value){
                debugger;
                $scope.visit.Source_Of_Funding__c = value
            }
            $scope.changeOfEthnicity = function(value){
                debugger;
                $scope.visit.Ethnicity__c = value
            }

            })

            .directive('soDropdown', ['$timeout', function($timeout) {
    return {
        restrict: 'E',
        require: 'ngModel',
        replace: true,
        transclude: true,
        template: function (el, atts) {
            var itemName = 'dropdownItem';
            var valueField = itemName + '.' + (atts.valueField || 'Id');
            var textField = itemName + '.' + (atts.textField || 'Name');
            return "<select class='ui search dropdown'>" +
                "<div ng-transclude></div>" +
                "   <option value='{{" + valueField + "}}' ng-repeat='" + itemName + " in " + atts.dropdownItems + " track by " + valueField + "'>" +
                "       {{" + textField + "}}" +
                "   </option>" +
                "</select>";
        },
        link: function (scope, el, atts, ngModel) {
            $(el).dropdown({
                onChange: function (value, text, choice) {
                    scope.$apply(function () {
                        ngModel.$setViewValue(value);
                    });
                }
            });
            ngModel.$render = function () {
                console.log('set value', el, ngModel, ngModel.$viewValue);
                $timeout(function () {
                    $(el).dropdown('set value', ngModel.$viewValue);
                });
                // $(el).dropdown('set value', ngModel.$viewValue);
            };
        }
    };
}]);
        </script>

        <div ng-app="visit_app" ng-controller="visit_ctrl" style="overflow-x: hidden;">
            <body>
                <!-- <div class="header-siteVisit">
                    <h3 class="header-text text-center">VAISHNAVI</h3>
                </div> -->
                <div class="row">
                    <div class="col-md-4"></div>
                    <div class="col-md-4"></div>
                    <div class="col-md-4 float-end" style="padding-left: 15%;">
                        <apex:image url="{!$Resource.New}" />
                    </div>
                    <!-- <div class="col-md-4">
                        <h5 class="heading text-center"><b>VAISHNAVI 81 INFRASTRUCTURES LLP</b></h5>
                        <h5 class="heading-loc text-center">Yelahanka, Bengaluru</h5>
                    </div>
                    <div class="col-md-4" style="padding-right: 2%;">
                        <h6 class="header-address">#2/2,Waltaon Road Off Vittal Mallya Road<br/>
                            Bengaluru - 560 001<br/>
                            +91 80 6696 6696<br/>
                            www.vaishnavilife.com</h6>
                    </div> -->
                </div>
                <hr class="border" />

                <div class="booking-form3">
                    <div class="container mb-5">
                        <!-- <h5 class="heading text-center"><b>SITE VISIT FORM</b></h5> -->

                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label class="label">Enter Email or Phone</label>
                                <input type="text" class="form-control mt-2" ng-model="searchValue" />
                            </div>
                            <div class="col-md-7 mt-4">
                                <button class="button" ng-click="searchLead()">Search</button>
                                <!-- <button class="button" ng-click="createLead()"><i class="fa fa-plus"></i>  Create New Lead</button> -->
                                <button class="button" ng-show="showLeadDetails || showVisitAfterCreatn || showConvertedLead" id="btnSubmit1" ng-click="OnClickcreateVisit()">Create Visit</button>
                                <button class="button" id="btnPleaseWait1" style="text-align: center; display:none;"><i class="fa-solid fa-spinner fa-spin-pulse me-3"></i>Please Wait....</button>
                            </div>
                        </div>

                        <div class="row mt-5" ng-show="errorMsg">
                            <h3 style="color: red; text-align:center;">No such record available ! Try Again.....</h3>
                        </div>

                        <div class="row mt-5" ng-show="showProjectsErrMsg">
                            <h3 style="color: red; text-align:center;">Visit Created..</h3>
                        </div>

                        <div class="row mt-5" ng-show="showErrmsgOppSV">
                            <h3 style="color: red; text-align:center;">Opportunity and Visit Created..</h3>
                        </div>

                        <div class="row mt-5" ng-show="showLeadDetails">
                            <h6 style="color:#1e45aa;"><b>Lead Details</b></h6>
                            <div class="col-md-6 mt-3">
                                <label class="label pe-3 text-nowrap">Name</label>
                                <input type="text" class="form-control" ng-model="leadDetails.Name__c" ng-disabled="true" />
                            </div>

                            <div class="col-md-6 mt-3">
                                <label class="label pe-3 text-nowrap">Email ID</label>
                                <input type="text" class="form-control" ng-model="leadDetails.Email__c" ng-disabled="true" />
                            </div>

                            <div class="col-md-6 mt-3">
                                <label class="label pe-3 text-nowrap">Phone No.</label>
                                <input type="text" class="form-control" ng-model="leadDetails.Phone__c" ng-disabled="true" />
                            </div>

                        </div>

                        <div class="row mt-5" ng-show="showConvertedLead">
                            <h4 style="color: red; text-align:center;">Already visited site... Please check Visit Records !!</h4>
                            <div class="col-md-4 mt-5">
                                <label class="label pe-3 text-nowrap">Name</label>
                                <input type="text" class="form-control" ng-model="oppDetails.Opportunity_Name__c" ng-disabled="true" /> 
                            </div>
                            <div class="col-md-4 mt-5">
                                <label class="label pe-3 text-nowrap">Email</label>
                                <input type="email" class="form-control" ng-model="oppDetails.Email__c" ng-disabled="true" /> 
                            </div>
                            <div class="col-md-4 mt-5">
                                <label class="label pe-3 text-nowrap">Phone</label>
                                <input type="tel" class="form-control" ng-model="oppDetails.Phone__c" ng-disabled="true" /> 
                            </div>
                            <h5 class="row mt-3 heading text-center">
                                Visit Records
                            </h5>
                            <table class="table mt-3">
                                <tr>
                                    <th>S.No.</th>
                                    <th>Visit Date</th>
                                    <th>Walkin Source</th>
                                    <th>Channel Partner Name</th>
                                    <th>Referral Name</th>
                                    <th>GRE Email</th>
                                    <th>Budget</th>
                                    <th>Project</th>
                                </tr>
                                <tr ng-repeat="rec in siteVisitList">
                                    <td>{{$index+1}}</td>
                                    <td>{{rec.Actual_visit_date__c | date:'dd-MM-yyyy'}}</td>
                                    <td>{{rec.Walkin_Source__c}}</td>
                                    <td>{{rec.Channel_Partner_Name__c}}</td>
                                    <td>{{rec.Referral_Name__c}}</td>
                                    <td>{{rec.GRE_Email__c}}</td>
                                    <td>{{rec.Budget__c}}</td>
                                    <td>{{rec.Project__r.Name}}</td>
                                </tr>
                            </table>
                        </div>

                        <div ng-show="showCreateLead">
                            <div class="row mt-5">
                                <h6 style="color:#1e45aa;"><b>Create New Lead</b></h6>
                                <div class="col-md-6 mt-3">
                                    <label class="label pe-3 text-nowrap">Name</label>
                                    <input type="text" class="form-control" ng-model="ledDetails.Name__c" />
                                </div>
    
                                <div class="col-md-6 mt-3">
                                    <label class="label pe-3 text-nowrap">Email ID</label>
                                    <input type="text" class="form-control" ng-model="ledDetails.Email__c" />
                                </div>
    
                                <div class="col-md-6 mt-3">
                                    <label class="label pe-3 text-nowrap">Phone No.</label>
                                    <input type="text" class="form-control" ng-model="ledDetails.Phone__c" />
                                </div>
                            </div>

                            <div class="row mt-5">
                                <!-- <div class="d-grid gap-2">
                                    <button class="btn btn-success btn-block" id="btnSubmit" ng-click="saveContact()" type="submit">Submit</button>
                                </div> -->
                                <div class="col-md-12">
                                    <button class="button" id="btnSubmit" style="text-align: center;" ng-click="createLeadRecord()">Create</button>
                                    <button class="button" id="btnPleaseWait" style="text-align: center; display:none;"><i class="fa-solid fa-spinner fa-spin-pulse me-3"></i>Please Wait....</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>



                <div class="booking-form" ng-if="showVisitSection">
                    <div class="container mb-5">
                        <!-- <h5 class="heading text-center"><b>SITE VISIT FORM</b></h5> -->

                        <div class="row justify-content-between">
                            <div class="col-md-3">
                                <!-- <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Form No.</label>
                                    <input type="text" class="form-control" ng-model="visit.Form_No__c"/>
                                </div> -->
                            </div>
                            <div class="col-md-3">
                                
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Date of visit:</label>
                                        <input type="date" class="form-control" placeholder="DD/MM/YYYY" ng-model="today" ng-disabled="true"/>
                                </div>
                            </div>
                        </div>

                        <div class="form-tabs">
                            <div class="sidebar col-md-auto">
                                <ul>
                                    <li class="active">
                                        <a ng-click="">Customer Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Customer's Requirements</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Visit Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">To be filled by GRE</a>
                                    </li>
                                    <!-- <li>
                                        <a ng-click="">To be filled by Sales Manager</a>
                                    </li> -->
                                </ul>
                            </div>

                            <div class="rightbar">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Name:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <input type="text" class="form-control" ng-model="leadRecord[0].Name__c"/>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Mobile No.:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="tel" class="form-control" ng-model="leadRecord[0].Phone__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Email:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="email" class="form-control" ng-model="leadRecord[0].Email__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Date of Birth:</label><span class="required-asterisk" style="color:red;">*</span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="date" class="form-control" ng-model="visit.Date_Of_Birth__c" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Alternate Phone:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="tel" class="form-control" ng-model="visit.Alternate_Phone__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Date of Birth:</label>
                                            </div>
                                            <div class="col-md-6">
                                                <input type="date" class="form-control" ng-model="visit.Date_Of_Birth__c" />
                                            </div>
                                        </div> -->
                                        <!-- <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Age(in years):</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in ageGroup">
                                                        <input type="radio" ng-model="visit.Age_Group__c" ng-value="value" ng-change="changeOfAgeGroup(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Residential Address:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <textarea class="form-control" ng-model="visit.Residential_Address__c"/>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Residence City:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.City__c" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Locality:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <so-dropdown ng-model="visit.Location__c" dropdown-items="listOfLocation">
                                                            <option value='None'>None</option>
                                                        </so-dropdown>
                                                        <!-- <select class="form-control" aria-label="Default select example" ng-model="visit.Location__c">
                                                            <option ng-repeat="location in listOfLocation">{{location.Name}}</option>
                                                        </select> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Pin Code:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <input class="form-control" type="text" ng-model="visit.Pincode__c"/>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Employment Type:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in employmentType">
                                                        <input type="radio" ng-model="visit.Employment_Type__c" ng-value="value" ng-change="ChangeOfEmpType(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-if="visit.Employment_Type__c == 'Salaried' || visit.Employment_Type__c == 'Business' || visit.Employment_Type__c == 'Professional'">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Company Name:</label><span class="required-asterisk" style="color:red;">*</span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Company_Name__c" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Industry:</label><span class="required-asterisk" style="color:red;">*</span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Industry__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Office Location:</label><span class="required-asterisk" style="color:red;">*</span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <textarea class="form-control" ng-model="visit.Office_Address__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Pin Code:</label><span class="required-asterisk" style="color:red;">*</span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Office_PinCode__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="button" class="button float-end" ng-click="saveCustomerDet()">Save and Next</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>




                <div class="booking-form" ng-if="showCustReq">
                    <div class="container mb-5">
                        <!-- <h5 class="heading text-center"><b>SITE VISIT FORM</b></h5> -->

                        <!-- <div class="row justify-content-between">
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Form No.</label>
                                    <input type="text" class="form-control" ng-model="visit.Form_No__c"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Date of visit:</label>
                                        <input type="date" class="form-control" placeholder="DD/MM/YYYY" ng-model="visit.Actual_visit_date__c"/>
                                </div>
                            </div>
                        </div> -->

                        <div class="form-tabs">
                            <div class="sidebar col-md-auto">
                                <ul>
                                    <li>
                                        <a ng-click="">Customer Details</a>
                                    </li>
                                    <li class="active">
                                        <a ng-click="">Customer's Requirements</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Visit Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">To be filled by GRE</a>
                                    </li>
                                    <!-- <li>
                                        <a ng-click="">To be filled by Sales Manager</a>
                                    </li> -->
                                </ul>
                            </div>

                            <div class="rightbar">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Budget(in Lakhs):</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in budgetValue">
                                                        <input type="radio" ng-model="visit.Budget__c" ng-value="value" ng-change="changeOfBudget(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Unit Type:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in unitValue">
                                                        <input type="radio" ng-model="visit.Area__c" ng-value="value" ng-change="changeOfArea(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Project Completion <br/>Timeline:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in constructionStatus">
                                                        <input type="radio" ng-model="visit.Construction_Status__c" ng-value="value" ng-change="changeOfConstStatus(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Purpose Of Buying:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in purposeOfBuying">
                                                        <input type="radio" ng-model="visit.Purpose_Of_Buying__c" ng-value="value" ng-change="changeOfPurposeOfBuying(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="button" class="button float-end" ng-click="saveCustomerReq()">Save and Next</button>
                                                <button type="button" class="cancelbutton float-end me-2" ng-click="showFirst()">Back</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>




                <div class="booking-form" ng-if="visitDet">
                    <div class="container mb-5">
                        <!-- <h5 class="heading text-center"><b>SITE VISIT FORM</b></h5> -->

                        <!-- <div class="row justify-content-between">
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Form No.</label>
                                    <input type="text" class="form-control" ng-model="visit.Form_No__c"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Date of visit:</label>
                                        <input type="date" class="form-control" placeholder="DD/MM/YYYY" ng-model="visit.Actual_visit_date__c"/>
                                </div>
                            </div>
                        </div> -->

                        <div class="form-tabs">
                            <div class="sidebar col-md-auto">
                                <ul>
                                    <li>
                                        <a ng-click="">Customer Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Customer's Requirements</a>
                                    </li>
                                    <li class="active">
                                        <a ng-click="">Visit Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">To be filled by GRE</a>
                                    </li>
                                    <!-- <li>
                                        <a ng-click="">To be filled by Sales Manager</a>
                                    </li> -->
                                </ul>
                            </div>

                            <div class="rightbar">
                                <div class="row">
                                    <div class="col-md-12">
                                        <!-- <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Visiting with:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Visiting_With__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Visiting on<br/>behalf of:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Visiting_On_Behalf_Of__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Walkin Source:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in walkinSource">
                                                        <input type="radio" ng-model="visit.Walkin_Source__c" ng-value="value" ng-change="changeOfLeadSource(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Walkin Source Social Media Ad -->
                                        <div ng-show="visit.Walkin_Source__c == 'Social Media Ad'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Facebook" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Facebook
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Instagram" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Instagram
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="LinkedIn" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                LinkedIn
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="YouTube" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                YouTube
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Walkin Source Google Ad -->
                                        <div ng-show="visit.Walkin_Source__c == 'Google Ad'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Search Ad" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Search Ad
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Display Ad" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Display Ad
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Walkin Source Property Portal -->
                                        <div ng-show="visit.Walkin_Source__c == 'Property Portal'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="99 acres" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                99 acres
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Housing" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Housing
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Commonfloor" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Commonfloor
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Magicbricks" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Magicbricks
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Roof & Floor" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                Roof and Floor
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Walkin Source Referral -->
                                        <div ng-show="visit.Walkin_Source__c == 'Referral'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="V-Connect" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                V-Connect
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="V-Team" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                V-Team
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="V-Associates" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <label class="font-if ps-3">
                                                                V-Associates
                                                            </label>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                            </div>

                                            <div ng-show="visit.Walkin_Sub_Source__c == 'V-Team' || visit.Walkin_Sub_Source__c == 'V-Associates' || visit.Walkin_Sub_Source__c == 'V-Connect'">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h4 class="label">Please Specify:</h4>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Name:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Referral_Name__c"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Mobile No.:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="tel" class="form-control" ng-model="visit.Referral_Mobile_No__c" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row" ng-show="visit.Walkin_Sub_Source__c == 'V-Connect'">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Project:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Projects__c"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Apartment No.:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Apartment_No__c" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>

                                        <!-- Walkin Source Activation -->
                                        <div ng-show="visit.Walkin_Source__c == 'Activation'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="NPI" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c" ng-change="changeOfRadioActivation()"/>
                                                            <label class="font-if ps-3">
                                                                NPI
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="RWA" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c" ng-change="changeOfRadioActivation()"/>
                                                            <label class="font-if ps-3">
                                                                RWA
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Corporate" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c" ng-change="changeOfRadioActivation()"/>
                                                            <label class="font-if ps-3">
                                                                Corporate
                                                            </label>
                                                        </div>
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-check-input" type="radio" value="Mall" name="radioPurpose" ng-model="visit.Walkin_Sub_Source__c" ng-change="changeOfRadioActivation()"/>
                                                            <label class="font-if ps-3">
                                                                Mall
                                                            </label>
                                                        </div>
                                                        <div class="col-md-10">
                                                            <div class="row">
                                                                <div class="col-md-4 mt-3">
                                                                    <input class="form-control" type="text" id="activationText" ng-model="activationInputText" ng-value="value" ng-change="changeOfActivation()"/>
                                                                    <!-- <label class="font-if ps-3">
                                                                        NPI
                                                                    </label> -->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Walkin Source Events & Expo -->
                                        <div ng-show="visit.Walkin_Source__c == 'Events and Expo'">
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Walkin Sub Source:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <div class="row">
                                                        <div class="col-md-4 mt-3">
                                                            <input class="form-control" type="text" ng-model="visit.Walkin_Sub_Source__c"/>
                                                            <!-- <label class="font-if ps-3">
                                                                NPI
                                                            </label> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div ng-show="visit.Walkin_Source__c == 'Channel Partner'">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h4 class="label">If-case of Channel Partner mention the following:</h4>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Channel Partner<br/>Name:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <so-dropdown ng-model="visit.Channel_Partner__c" dropdown-items="listOfChannelPartner">
                                                                <option value='None'>None</option>
                                                            </so-dropdown>
                                                            <!-- <input type="text" class="form-control" ng-model="visit.Channel_Partner_Name__c" /> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Email:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="email" class="form-control" ng-model="visit.Channel_Partner_Email__c"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">RERA No.:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.RERA_No__c" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row align-items-center mb-4">
                                                <div class="col-md-2">
                                                    <label class="label">Mobile No.:</label>
                                                </div>
                                                <div class="col-md-10">
                                                    <input type="tel" class="form-control" ng-model="visit.Channel_Partner_Mobile_No__c"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div ng-show="visit.Walkin_Source__c == 'Site Visit Referral' || visit.Walkin_Source__c == 'V-Team' || visit.Walkin_Source__c == 'V-Associates' || visit.Walkin_Source__c == 'V-Connect'">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h4 class="label">Please Specify:</h4>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Name:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Referral_Name__c"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Mobile No.:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="tel" class="form-control" ng-model="visit.Referral_Mobile_No__c" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row" ng-show="visit.Walkin_Source__c == 'V-Connect'">
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Project:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Projects__c"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Apartment No.:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="visit.Apartment_No__c" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="button" class="button float-end" ng-click="savevisitDetails()">Save and Next</button>
                                                <button type="button" class="cancelbutton float-end me-2" ng-click="showSecond()">Back</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="booking-form" ng-if="showGRE">
                    <div class="container mb-5">
                        <!-- <h5 class="heading text-center"><b>SITE VISIT FORM</b></h5> -->

                        <!-- <div class="row justify-content-between">
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Form No.</label>
                                    <input type="text" class="form-control" ng-model="visit.Form_No__c"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Date of visit:</label>
                                        <input type="date" class="form-control" placeholder="DD/MM/YYYY" ng-model="visit.Actual_visit_date__c"/>
                                </div>
                            </div>
                        </div> -->

                        <div class="form-tabs">
                            <div class="sidebar col-md-auto">
                                <ul>
                                    <li>
                                        <a ng-click="">Customer Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Customer's Requirements</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Visit Details</a>
                                    </li>
                                    <li class="active">
                                        <a ng-click="">To be filled by GRE</a>
                                    </li>
                                    <!-- <li>
                                        <a ng-click="">To be filled by Sales Manager</a>
                                    </li> -->
                                </ul>
                            </div>

                            <div class="rightbar">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row">

                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Attending Sales<br/>Manager:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <so-dropdown ng-model="visit.Sales_Manager__c" dropdown-items="listOfSalesManager">
                                                                <option value='None'>None</option>
                                                            </so-dropdown>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="row align-items-center mb-4">
                                                        <div class="col-md-4">
                                                            <label class="label">Assigned<br/>Manager:</label>
                                                        </div>
                                                        <div class="col-md-8">
                                                            <input type="text" class="form-control" ng-model="leadDetails.Owner.Name" ng-disabled="true" />
                                                        </div>
                                                    </div>
                                                </div>
                                        </div>


                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Facilitated By<br/>Pre-Sales:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in facilitatedBy">
                                                        <input type="radio" ng-model="visit.Facilitated_By__c" ng-value="value" ng-change="changeOfFacilitatedBy(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Mobile No.:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="tel" class="form-control" ng-model="visit.GRE_Mobile_No__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Email:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="email" class="form-control" ng-model="visit.GRE_Email__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->
                                        <!-- <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Date Of Birth:</label>
                                            </div>
                                            <div class="col-md-4">
                                                <input type="date" class="form-control" ng-model="visit.GRE_Date_of_Birth__c"/>
                                            </div>
                                        </div> -->
                                        <!-- <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Customer<br/>Time-In:</label>
                                                        {{timeString}}
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="timeString" ng-disabled="true"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Customer<br/>Time-Out:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="time" class="form-control" ng-model="visit.Customer_Time_Out__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div> -->

                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="button" class="button float-end" ng-click="saveGREDetails()">Submit</button>
                                                <button type="button" class="cancelbutton float-end me-2" ng-click="showThird()">Back</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- <div class="booking-form" ng-if="showSalesManager">
                    <div class="container mb-5">

                        <div class="row justify-content-between">
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Form No.</label>
                                    <input type="text" class="form-control" ng-model="visit.Form_No__c"/>
                                </div>
                            </div>
                            <div class="col-md-3">
                                
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center">
                                    <label class="label pe-3 text-nowrap">Date of visit:</label>
                                        <input type="date" class="form-control" placeholder="DD/MM/YYYY" ng-model="visit.Actual_visit_date__c"/>
                                </div>
                            </div>
                        </div>

                        <div class="form-tabs">
                            <div class="sidebar col-md-auto">
                                <ul>
                                    <li>
                                        <a ng-click="">Customer Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Customer's Requirements</a>
                                    </li>
                                    <li>
                                        <a ng-click="">Visit Details</a>
                                    </li>
                                    <li>
                                        <a ng-click="">To be filled by GRE</a>
                                    </li>
                                    <li class="active">
                                        <a ng-click="">To be filled by Sales Manager</a>
                                    </li>
                                </ul>
                            </div>

                            <div class="rightbar">
                                <div class="row">
                                    <div class="col-md-12">

                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Customer <br/>Classification:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in classification">
                                                        <input type="radio" ng-model="visit.Customer_Classicfication__c" ng-value="value" ng-change="changeOfClassification(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Lead <br/>Classification:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in leadClassification">
                                                        <input type="radio" ng-model="visit.Lead_Classification__c" ng-value="value" ng-change="changeOfLeadClassificatn(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">If Closed, <br/>Reason for it:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in closedReason">
                                                        <input type="radio" ng-model="visit.Reason_Of_Lead_Closed__c" ng-value="value" ng-change="changeOfLeadClosed(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h4 class="label">Customer's current Residence:</h4>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Ownership:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in ownership">
                                                        <input type="radio" ng-model="visit.Current_House_Ownership__c" ng-value="value" ng-change="changeOfOwnership(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Configuration:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Configuration__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Family Size:</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="number" class="form-control" ng-model="visit.Family_Size__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-4">
                                                <label class="label">Current Floor No.:</label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="number" class="form-control" ng-model="visit.Current_Floor_No__c"/>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <h4 class="label">Customer's desired requirement:</h4>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Budget(INR):</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="number" class="form-control" ng-model="visit.Customer_s_Desired_Budget__c"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="row align-items-center mb-4">
                                                    <div class="col-md-4">
                                                        <label class="label">Location(E/w):</label>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control" ng-model="visit.Customer_s_Desired_Location_E_W__c" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Source Of<br/>Funding:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in sourceOfFunding">
                                                        <input type="radio" ng-model="visit.Source_Of_Funding__c" ng-value="value" ng-change="changeOfSourceFunding(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mb-4">
                                            <div class="col-md-2">
                                                <label class="label">Ethnicity:</label>
                                            </div>
                                            <div class="col-md-10">
                                                <div class="row">
                                                    <div class="col-md-4 pt-3" ng-repeat="value in ethnicity">
                                                        <input type="radio" ng-model="visit.Ethnicity__c" ng-value="value" ng-change="changeOfEthnicity(value)" />
                                                        <label>{{value}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-12">
                                                <button type="button" class="button float-end" ng-click="finalSubmit()">Submit</button>
                                                <button type="button" class="cancelbutton float-end me-2" ng-click="showForth()">Back</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
            </body>
        </div>
    </html>
</apex:page>